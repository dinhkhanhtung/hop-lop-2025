<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ÄÄƒng kÃ½ há»p lá»›p</title>
  <style>
    :root{
      --green-1:#4CAF50;
      --green-2:#2ecc71;
      --card-bg:#ffffff;
      --rounded:12px;
    }
    body {
      font-family: "Segoe UI", Roboto, Arial, sans-serif;
      margin: 0;
      background: linear-gradient(90deg, #e8f5e9, #f1f8f0);
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      padding: 16px;
    }
    .container {
      width: 100%;
      max-width: 520px;
      background: var(--card-bg);
      border-radius: var(--rounded);
      box-shadow: 0 6px 22px rgba(0,0,0,0.08);
      overflow: hidden;
    }

    /* === Dáº£i mÃ u (header gradient) === */
    .header {
      padding: 20px 16px;
      background: linear-gradient(135deg, var(--green-1), var(--green-2));
      color: white;
      text-align: center;
    }
    .header h1 {
      margin: 0;
      font-size: 1.2rem;
      letter-spacing: 0.2px;
    }
    .header p {
      margin: 6px 0 0;
      font-size: 0.9rem;
      opacity: 0.95;
    }

    .content {
      padding: 18px;
    }
    label {
      display: block;
      margin-top: 12px;
      font-weight: 600;
      color: #333;
      font-size: 0.95rem;
    }
    input[type="text"],
    input[type="tel"],
    input[type="number"],
    select,
    textarea {
      width: 100%;
      padding: 10px 12px;
      margin-top: 6px;
      border-radius: 10px;
      border: 1px solid #d4d4d4;
      box-sizing: border-box;
      font-size: 15px;
      background: #fff;
    }
    textarea { resize: vertical; min-height: 80px; }

    .row {
      display: flex;
      gap: 12px;
    }
    .row > * { flex: 1; }

    button {
      margin-top: 16px;
      width: 100%;
      padding: 12px;
      font-size: 16px;
      font-weight: 700;
      background: var(--green-1);
      color: #fff;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }
    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    #loadingText {
      display: none;
      text-align: center;
      margin-top: 10px;
      font-style: italic;
      color: #2e7d32;
    }

    /* Popup modal */
    .popup {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.45);
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    .popup-inner {
      background: #fff;
      padding: 18px 20px;
      border-radius: 12px;
      text-align: center;
      width: min(92%, 360px);
      box-shadow: 0 8px 30px rgba(0,0,0,0.2);
    }
    .popup-inner h3 { margin: 0 0 8px; color: #27ae60; }
    .popup-inner p { margin: 0 0 12px; color: #333; }
    .popup-inner button {
      background: #27ae60;
      color: #fff;
      padding: 10px 14px;
      border-radius: 8px;
      border: none;
      font-weight: 700;
      cursor: pointer;
    }

    @media (max-width:420px){
      .header h1{ font-size: 1.05rem; }
      .content{ padding: 14px; }
    }
  </style>
</head>
<body>

  <div class="container" role="main">
    <!-- Header with gradient (dáº£i mÃ u) -->
    <div class="header" aria-hidden="false">
      <h1>ğŸ“ ÄÄƒng kÃ½ há»p lá»›p â€” 04/10/2025</h1>
      <p>KhÃ¡ch má»i: CÃ´ Báº±ng, Tháº§y CÆ°á»ng, Tháº§y Báº¯c â€” Vui lÃ²ng Ä‘iá»n thÃ´ng tin</p>
    </div>

    <div class="content">
      <form id="classForm" autocomplete="on">
        <label for="name">Há» vÃ  tÃªn *</label>
        <input id="name" name="name" type="text" required placeholder="Nguyá»…n VÄƒn A">

        <label for="phone">Sá»‘ Ä‘iá»‡n thoáº¡i *</label>
        <!-- type text Ä‘á»ƒ giá»¯ sá»‘ 0 Ä‘áº§u; pattern giá»›i háº¡n 9-11 chá»¯ sá»‘ -->
        <input id="phone" name="phone" type="text" inputmode="numeric" required
               pattern="0?[0-9]{8,10}" placeholder="VÃ­ dá»¥: 0912345678">

        <label for="social">Facebook / Zalo (link hoáº·c tÃªn)</label>
        <input id="social" name="social" type="text" placeholder="https://facebook.com/xxx hoáº·c Zalo">

        <label for="location">Tá»‰nh/ThÃ nh *</label>
        <select id="location" name="location" required>
          <option value="">-- Chá»n tá»‰nh/thÃ nh --</option>
          <option>An Giang</option><option>BÃ  Rá»‹a - VÅ©ng TÃ u</option><option>Báº¡c LiÃªu</option>
          <option>Báº¯c Káº¡n</option><option>Báº¯c Giang</option><option>Báº¯c Ninh</option>
          <option>Báº¿n Tre</option><option>BÃ¬nh DÆ°Æ¡ng</option><option>BÃ¬nh Äá»‹nh</option>
          <option>BÃ¬nh PhÆ°á»›c</option><option>BÃ¬nh Thuáº­n</option><option>CÃ  Mau</option>
          <option>Cao Báº±ng</option><option>Cáº§n ThÆ¡</option><option>ÄÃ  Náºµng</option>
          <option>Äáº¯k Láº¯k</option><option>Äáº¯k NÃ´ng</option><option>Äiá»‡n BiÃªn</option>
          <option>Äá»“ng Nai</option><option>Äá»“ng ThÃ¡p</option><option>Gia Lai</option>
          <option>HÃ  Giang</option><option>HÃ  Nam</option><option>HÃ  Ná»™i</option>
          <option>HÃ  TÄ©nh</option><option>Háº£i DÆ°Æ¡ng</option><option>Háº£i PhÃ²ng</option>
          <option>Háº­u Giang</option><option>HÃ²a BÃ¬nh</option><option>HÆ°ng YÃªn</option>
          <option>KhÃ¡nh HÃ²a</option><option>KiÃªn Giang</option><option>Kon Tum</option>
          <option>Lai ChÃ¢u</option><option>Láº¡ng SÆ¡n</option><option>LÃ o Cai</option>
          <option>LÃ¢m Äá»“ng</option><option>Long An</option><option>Nam Äá»‹nh</option>
          <option>Nghá»‡ An</option><option>Ninh BÃ¬nh</option><option>Ninh Thuáº­n</option>
          <option>PhÃº Thá»</option><option>PhÃº YÃªn</option><option>Quáº£ng BÃ¬nh</option>
          <option>Quáº£ng Nam</option><option>Quáº£ng NgÃ£i</option><option>Quáº£ng Ninh</option>
          <option>Quáº£ng Trá»‹</option><option>SÃ³c TrÄƒng</option><option>SÆ¡n La</option>
          <option>TÃ¢y Ninh</option><option>ThÃ¡i BÃ¬nh</option><option>ThÃ¡i NguyÃªn</option>
          <option>Thanh HÃ³a</option><option>Thá»«a ThiÃªn Huáº¿</option><option>Tiá»n Giang</option>
          <option>TP Há»“ ChÃ­ Minh</option><option>TrÃ  Vinh</option><option>TuyÃªn Quang</option>
          <option>VÄ©nh Long</option><option>VÄ©nh PhÃºc</option><option>YÃªn BÃ¡i</option>
        </select>

        <label for="attend">Báº¡n cÃ³ tham gia?</label>
        <select id="attend" name="attend">
          <option value="CÃ³">CÃ³</option>
          <option value="ChÆ°a cháº¯c">ChÆ°a cháº¯c</option>
          <option value="KhÃ´ng">KhÃ´ng</option>
        </select>

        <div class="row">
          <div>
            <label for="companions">Sá»‘ ngÆ°á»i Ä‘i cÃ¹ng</label>
            <input id="companions" name="companions" type="number" min="0" value="0">
          </div>
          <div>
            <label for="empty">&nbsp;</label>
            <input style="visibility:hidden" aria-hidden="true">
          </div>
        </div>

        <label for="suggestion">GÃ³p Ã½ / Äá» xuáº¥t</label>
        <textarea id="suggestion" name="suggestion" rows="3" placeholder="VD: muá»‘n tá»• chá»©c á»Ÿ HÃ  Ná»™i, Æ°u tiÃªn Äƒn uá»‘ng..."></textarea>

        <button type="submit" id="submitBtn">Gá»­i thÃ´ng tin</button>
        <div id="loadingText">â³ Äang gá»­i, vui lÃ²ng chá»...</div>
      </form>
    </div>
  </div>

  <!-- Popup -->
  <div class="popup" id="popup" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="popup-inner" role="document">
      <h3>âœ… ÄÃ£ gá»­i thÃ nh cÃ´ng!</h3>
      <p>Cáº£m Æ¡n báº¡n â€” chÃºng mÃ¬nh sáº½ gá»i xÃ¡c nháº­n Ä‘á»ƒ chá»‘t danh sÃ¡ch.</p>
      <button id="closePopupBtn">ÄÃ³ng</button>
    </div>
  </div>

  <script>
    // === Thay báº±ng link Web App /exec cá»§a báº¡n ===
    const scriptURL = "https://script.google.com/macros/s/AKfycbx6rHxgPTVimX2OaAB442uUHUK_9X2HN0fdhbjKmeogk89h0UJfnS4Gajqt3boo_DFY/exec";

    const form = document.getElementById('classForm');
    const submitBtn = document.getElementById('submitBtn');
    const loadingText = document.getElementById('loadingText');
    const popup = document.getElementById('popup');
    const closePopupBtn = document.getElementById('closePopupBtn');

    // Hiá»ƒn thá»‹ popup khi URL cÃ³ ?success=1 (chá»‘ng F5 gá»­i láº¡i)
    window.addEventListener('DOMContentLoaded', () => {
      const params = new URLSearchParams(window.location.search);
      if (params.get('success') === '1') {
        showPopup();
        // XÃ³a param khá»i URL Ä‘á»ƒ F5 khÃ´ng hiá»‡n láº¡i popup
        window.history.replaceState({}, document.title, window.location.pathname);
      }
    });

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      // simple client-side validation for phone pattern
      const phoneInput = document.getElementById('phone');
      const phoneOk = phoneInput.checkValidity();
      if (!phoneOk) {
        alert('Vui lÃ²ng nháº­p sá»‘ Ä‘iá»‡n thoáº¡i há»£p lá»‡ (vÃ­ dá»¥: 0912345678).');
        phoneInput.focus();
        return;
      }

      submitBtn.disabled = true;
      loadingText.style.display = 'block';

      try {
        const resp = await fetch(scriptURL, { method: 'POST', body: new FormData(form) });

        // náº¿u server tráº£ ok â†’ redirect Ä‘á»ƒ trÃ¡nh re-submit khi F5
        if (resp.ok) {
          // redirect vá»›i param success Ä‘á»ƒ hiá»‡n popup 1 láº§n
          window.location.href = window.location.pathname + '?success=1';
        } else {
          // Ä‘á»c body náº¿u cÃ³ Ä‘á»ƒ debug/hiá»‡n lá»—i
          const text = await resp.text();
          alert('CÃ³ lá»—i khi gá»­i dá»¯ liá»‡u. Vui lÃ²ng thá»­ láº¡i.\n' + (text || ''));
          submitBtn.disabled = false;
          loadingText.style.display = 'none';
        }
      } catch (err) {
        console.error('Fetch error:', err);
        alert('KhÃ´ng thá»ƒ káº¿t ná»‘i tá»›i server. Vui lÃ²ng kiá»ƒm tra láº¡i link Apps Script vÃ  quyá»n deploy.');
        submitBtn.disabled = false;
        loadingText.style.display = 'none';
      }
    });

    function showPopup() {
      popup.style.display = 'flex';
      popup.setAttribute('aria-hidden', 'false');
    }
    function hidePopup() {
      popup.style.display = 'none';
      popup.setAttribute('aria-hidden', 'true');
    }
    closePopupBtn.addEventListener('click', () => {
      hidePopup();
    });
  </script>
</body>
</html>
